{"id":"node_modules/snabbdom/src/package/modules/hero.ts","dependencies":[{"name":"E:\\tanwan-file\\tool-library\\virtual-dom\\snabbdom\\package.json","includedInParent":true,"mtime":1595993582237},{"name":"E:\\tanwan-file\\tool-library\\.browserslistrc","includedInParent":true,"mtime":1586828216661},{"name":"E:\\tanwan-file\\tool-library\\virtual-dom\\snabbdom\\node_modules\\snabbdom\\package.json","includedInParent":true,"mtime":1595994164182}],"generated":{"js":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.heroModule = void 0;\r\nvar raf = (typeof window !== 'undefined' && window.requestAnimationFrame) || setTimeout;\r\nvar nextFrame = function (fn) {\r\n    raf(function () {\r\n        raf(fn);\r\n    });\r\n};\r\nfunction setNextFrame(obj, prop, val) {\r\n    nextFrame(function () {\r\n        obj[prop] = val;\r\n    });\r\n}\r\nfunction getTextNodeRect(textNode) {\r\n    var rect;\r\n    if (document.createRange) {\r\n        var range = document.createRange();\r\n        range.selectNodeContents(textNode);\r\n        if (range.getBoundingClientRect) {\r\n            rect = range.getBoundingClientRect();\r\n        }\r\n    }\r\n    return rect;\r\n}\r\nfunction calcTransformOrigin(isTextNode, textRect, boundingRect) {\r\n    if (isTextNode) {\r\n        if (textRect) {\r\n            // calculate pixels to center of text from left edge of bounding box\r\n            var relativeCenterX = textRect.left + textRect.width / 2 - boundingRect.left;\r\n            var relativeCenterY = textRect.top + textRect.height / 2 - boundingRect.top;\r\n            return relativeCenterX + 'px ' + relativeCenterY + 'px';\r\n        }\r\n    }\r\n    return '0 0'; // top left\r\n}\r\nfunction getTextDx(oldTextRect, newTextRect) {\r\n    if (oldTextRect && newTextRect) {\r\n        return ((oldTextRect.left + oldTextRect.width / 2) - (newTextRect.left + newTextRect.width / 2));\r\n    }\r\n    return 0;\r\n}\r\nfunction getTextDy(oldTextRect, newTextRect) {\r\n    if (oldTextRect && newTextRect) {\r\n        return ((oldTextRect.top + oldTextRect.height / 2) - (newTextRect.top + newTextRect.height / 2));\r\n    }\r\n    return 0;\r\n}\r\nfunction isTextElement(elm) {\r\n    return elm.childNodes.length === 1 && elm.childNodes[0].nodeType === 3;\r\n}\r\nvar removed, created;\r\nfunction pre() {\r\n    removed = {};\r\n    created = [];\r\n}\r\nfunction create(oldVnode, vnode) {\r\n    var hero = vnode.data.hero;\r\n    if (hero && hero.id) {\r\n        created.push(hero.id);\r\n        created.push(vnode);\r\n    }\r\n}\r\nfunction destroy(vnode) {\r\n    var hero = vnode.data.hero;\r\n    if (hero && hero.id) {\r\n        var elm = vnode.elm;\r\n        vnode.isTextNode = isTextElement(elm); // is this a text node?\r\n        vnode.boundingRect = elm.getBoundingClientRect(); // save the bounding rectangle to a new property on the vnode\r\n        vnode.textRect = vnode.isTextNode ? getTextNodeRect(elm.childNodes[0]) : null; // save bounding rect of inner text node\r\n        var computedStyle = window.getComputedStyle(elm, undefined); // get current styles (includes inherited properties)\r\n        vnode.savedStyle = JSON.parse(JSON.stringify(computedStyle)); // save a copy of computed style values\r\n        removed[hero.id] = vnode;\r\n    }\r\n}\r\nfunction post() {\r\n    var i, id, newElm, oldVnode, oldElm, hRatio, wRatio, oldRect, newRect, dx, dy, origTransform, origTransition, newStyle, oldStyle, newComputedStyle, isTextNode, newTextRect, oldTextRect;\r\n    for (i = 0; i < created.length; i += 2) {\r\n        id = created[i];\r\n        newElm = created[i + 1].elm;\r\n        oldVnode = removed[id];\r\n        if (oldVnode) {\r\n            isTextNode = oldVnode.isTextNode && isTextElement(newElm); // Are old & new both text?\r\n            newStyle = newElm.style;\r\n            newComputedStyle = window.getComputedStyle(newElm, undefined); // get full computed style for new element\r\n            oldElm = oldVnode.elm;\r\n            oldStyle = oldElm.style;\r\n            // Overall element bounding boxes\r\n            newRect = newElm.getBoundingClientRect();\r\n            oldRect = oldVnode.boundingRect; // previously saved bounding rect\r\n            // Text node bounding boxes & distances\r\n            if (isTextNode) {\r\n                newTextRect = getTextNodeRect(newElm.childNodes[0]);\r\n                oldTextRect = oldVnode.textRect;\r\n                dx = getTextDx(oldTextRect, newTextRect);\r\n                dy = getTextDy(oldTextRect, newTextRect);\r\n            }\r\n            else {\r\n                // Calculate distances between old & new positions\r\n                dx = oldRect.left - newRect.left;\r\n                dy = oldRect.top - newRect.top;\r\n            }\r\n            hRatio = newRect.height / (Math.max(oldRect.height, 1));\r\n            wRatio = isTextNode ? hRatio : newRect.width / (Math.max(oldRect.width, 1)); // text scales based on hRatio\r\n            // Animate new element\r\n            origTransform = newStyle.transform;\r\n            origTransition = newStyle.transition;\r\n            if (newComputedStyle.display === 'inline') {\r\n                // inline elements cannot be transformed\r\n                newStyle.display = 'inline-block'; // this does not appear to have any negative side effects\r\n            }\r\n            newStyle.transition = origTransition + 'transform 0s';\r\n            newStyle.transformOrigin = calcTransformOrigin(isTextNode, newTextRect, newRect);\r\n            newStyle.opacity = '0';\r\n            newStyle.transform = origTransform +\r\n                'translate(' + dx + 'px, ' + dy + 'px) ' +\r\n                'scale(' + 1 / wRatio + ', ' + 1 / hRatio + ')';\r\n            setNextFrame(newStyle, 'transition', origTransition);\r\n            setNextFrame(newStyle, 'transform', origTransform);\r\n            setNextFrame(newStyle, 'opacity', '1');\r\n            // Animate old element\r\n            for (var key in oldVnode.savedStyle) { // re-apply saved inherited properties\r\n                if (String(parseInt(key)) !== key) {\r\n                    var ms = key.substring(0, 2) === 'ms';\r\n                    var moz = key.substring(0, 3) === 'moz';\r\n                    var webkit = key.substring(0, 6) === 'webkit';\r\n                    if (!ms && !moz && !webkit) {\r\n                        // ignore prefixed style properties\r\n                        oldStyle[key] = oldVnode.savedStyle[key];\r\n                    }\r\n                }\r\n            }\r\n            oldStyle.position = 'absolute';\r\n            oldStyle.top = oldRect.top + 'px'; // start at existing position\r\n            oldStyle.left = oldRect.left + 'px';\r\n            oldStyle.width = oldRect.width + 'px'; // Needed for elements who were sized relative to their parents\r\n            oldStyle.height = oldRect.height + 'px'; // Needed for elements who were sized relative to their parents\r\n            oldStyle.margin = '0'; // Margin on hero element leads to incorrect positioning\r\n            oldStyle.transformOrigin = calcTransformOrigin(isTextNode, oldTextRect, oldRect);\r\n            oldStyle.transform = '';\r\n            oldStyle.opacity = '1';\r\n            document.body.appendChild(oldElm);\r\n            setNextFrame(oldStyle, 'transform', 'translate(' + -dx + 'px, ' + -dy + 'px) scale(' + wRatio + ', ' + hRatio + ')'); // scale must be on far right for translate to be correct\r\n            setNextFrame(oldStyle, 'opacity', '0');\r\n            oldElm.addEventListener('transitionend', function (ev) {\r\n                if (ev.propertyName === 'transform') {\r\n                    document.body.removeChild(ev.target);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    removed = created = undefined;\r\n}\r\nexports.heroModule = { pre: pre, create: create, destroy: destroy, post: post };\r\n"},"sourceMaps":{"js":{"version":3,"file":"hero.js","sourceRoot":"","sources":["node_modules/snabbdom/src/package/modules/hero.ts"],"names":[],"mappings":"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","sourcesContent":["import { VNode, VNodeData } from '../vnode'\nimport { Module } from './module'\n\nexport type Hero = { id: string }\n\nvar raf = (typeof window !== 'undefined' && window.requestAnimationFrame) || setTimeout\nvar nextFrame = function (fn: any) {\n  raf(function () {\n    raf(fn)\n  })\n}\n\nfunction setNextFrame (obj: any, prop: string, val: any): void {\n  nextFrame(function () {\n    obj[prop] = val\n  })\n}\n\nfunction getTextNodeRect (textNode: Text): ClientRect | undefined {\n  var rect: ClientRect | undefined\n  if (document.createRange) {\n    var range = document.createRange()\n    range.selectNodeContents(textNode)\n    if (range.getBoundingClientRect) {\n      rect = range.getBoundingClientRect()\n    }\n  }\n  return rect\n}\n\nfunction calcTransformOrigin (\n  isTextNode: boolean,\n  textRect: ClientRect | undefined,\n  boundingRect: ClientRect\n): string {\n  if (isTextNode) {\n    if (textRect) {\n      // calculate pixels to center of text from left edge of bounding box\n      var relativeCenterX = textRect.left + textRect.width / 2 - boundingRect.left\n      var relativeCenterY = textRect.top + textRect.height / 2 - boundingRect.top\n      return relativeCenterX + 'px ' + relativeCenterY + 'px'\n    }\n  }\n  return '0 0' // top left\n}\n\nfunction getTextDx (\n  oldTextRect: ClientRect | undefined,\n  newTextRect: ClientRect | undefined\n): number {\n  if (oldTextRect && newTextRect) {\n    return ((oldTextRect.left + oldTextRect.width / 2) - (newTextRect.left + newTextRect.width / 2))\n  }\n  return 0\n}\nfunction getTextDy (\n  oldTextRect: ClientRect | undefined,\n  newTextRect: ClientRect | undefined\n): number {\n  if (oldTextRect && newTextRect) {\n    return ((oldTextRect.top + oldTextRect.height / 2) - (newTextRect.top + newTextRect.height / 2))\n  }\n  return 0\n}\n\nfunction isTextElement (elm: Element | Text): elm is Text {\n  return elm.childNodes.length === 1 && elm.childNodes[0].nodeType === 3\n}\n\nvar removed: any, created: any\n\nfunction pre () {\n  removed = {}\n  created = []\n}\n\nfunction create (oldVnode: VNode, vnode: VNode): void {\n  var hero = (vnode.data as VNodeData).hero\n  if (hero && hero.id) {\n    created.push(hero.id)\n    created.push(vnode)\n  }\n}\n\nfunction destroy (vnode: VNode): void {\n  var hero = (vnode.data as VNodeData).hero\n  if (hero && hero.id) {\n    var elm = vnode.elm;\n    (vnode as any).isTextNode = isTextElement(elm as Element | Text); // is this a text node?\n    (vnode as any).boundingRect = (elm as Element).getBoundingClientRect(); // save the bounding rectangle to a new property on the vnode\n    (vnode as any).textRect = (vnode as any).isTextNode ? getTextNodeRect((elm as Element).childNodes[0] as Text) : null // save bounding rect of inner text node\n    var computedStyle = window.getComputedStyle(elm as Element, undefined); // get current styles (includes inherited properties)\n    (vnode as any).savedStyle = JSON.parse(JSON.stringify(computedStyle)) // save a copy of computed style values\n    removed[hero.id] = vnode\n  }\n}\n\nfunction post () {\n  var i: number, id: any, newElm: Element, oldVnode: VNode, oldElm: Element,\n    hRatio: number, wRatio: number,\n    oldRect: ClientRect, newRect: ClientRect, dx: number, dy: number,\n    origTransform: string | null, origTransition: string | null,\n    newStyle: CSSStyleDeclaration, oldStyle: CSSStyleDeclaration,\n    newComputedStyle: CSSStyleDeclaration, isTextNode: boolean,\n    newTextRect: ClientRect | undefined, oldTextRect: ClientRect | undefined\n  for (i = 0; i < created.length; i += 2) {\n    id = created[i]\n    newElm = created[i + 1].elm\n    oldVnode = removed[id]\n    if (oldVnode) {\n      isTextNode = (oldVnode as any).isTextNode && isTextElement(newElm) // Are old & new both text?\n      newStyle = (newElm as HTMLElement).style\n      newComputedStyle = window.getComputedStyle(newElm, undefined) // get full computed style for new element\n      oldElm = oldVnode.elm as Element\n      oldStyle = (oldElm as HTMLElement).style\n      // Overall element bounding boxes\n      newRect = newElm.getBoundingClientRect()\n      oldRect = (oldVnode as any).boundingRect // previously saved bounding rect\n      // Text node bounding boxes & distances\n      if (isTextNode) {\n        newTextRect = getTextNodeRect(newElm.childNodes[0] as Text)\n        oldTextRect = (oldVnode as any).textRect\n        dx = getTextDx(oldTextRect, newTextRect)\n        dy = getTextDy(oldTextRect, newTextRect)\n      } else {\n        // Calculate distances between old & new positions\n        dx = oldRect.left - newRect.left\n        dy = oldRect.top - newRect.top\n      }\n      hRatio = newRect.height / (Math.max(oldRect.height, 1))\n      wRatio = isTextNode ? hRatio : newRect.width / (Math.max(oldRect.width, 1)) // text scales based on hRatio\n      // Animate new element\n      origTransform = newStyle.transform\n      origTransition = newStyle.transition\n      if (newComputedStyle.display === 'inline') {\n        // inline elements cannot be transformed\n        newStyle.display = 'inline-block' // this does not appear to have any negative side effects\n      }\n      newStyle.transition = origTransition + 'transform 0s'\n      newStyle.transformOrigin = calcTransformOrigin(isTextNode, newTextRect, newRect)\n      newStyle.opacity = '0'\n      newStyle.transform = origTransform +\n        'translate(' + dx + 'px, ' + dy + 'px) ' +\n        'scale(' + 1 / wRatio + ', ' + 1 / hRatio + ')'\n      setNextFrame(newStyle, 'transition', origTransition)\n      setNextFrame(newStyle, 'transform', origTransform)\n      setNextFrame(newStyle, 'opacity', '1')\n      // Animate old element\n      for (var key in (oldVnode as any).savedStyle) { // re-apply saved inherited properties\n        if (String(parseInt(key)) !== key) {\n          var ms = key.substring(0, 2) === 'ms'\n          var moz = key.substring(0, 3) === 'moz'\n          var webkit = key.substring(0, 6) === 'webkit'\n          if (!ms && !moz && !webkit) {\n            // ignore prefixed style properties\n            (oldStyle as any)[key] = (oldVnode as any).savedStyle[key]\n          }\n        }\n      }\n      oldStyle.position = 'absolute'\n      oldStyle.top = oldRect.top + 'px' // start at existing position\n      oldStyle.left = oldRect.left + 'px'\n      oldStyle.width = oldRect.width + 'px' // Needed for elements who were sized relative to their parents\n      oldStyle.height = oldRect.height + 'px' // Needed for elements who were sized relative to their parents\n      oldStyle.margin = '0' // Margin on hero element leads to incorrect positioning\n      oldStyle.transformOrigin = calcTransformOrigin(isTextNode, oldTextRect, oldRect)\n      oldStyle.transform = ''\n      oldStyle.opacity = '1'\n      document.body.appendChild(oldElm)\n      setNextFrame(oldStyle, 'transform', 'translate(' + -dx + 'px, ' + -dy + 'px) scale(' + wRatio + ', ' + hRatio + ')') // scale must be on far right for translate to be correct\n      setNextFrame(oldStyle, 'opacity', '0')\n      oldElm.addEventListener('transitionend', function (ev: TransitionEvent) {\n        if (ev.propertyName === 'transform') {\n          document.body.removeChild(ev.target as Node)\n        }\n      })\n    }\n  }\n  removed = created = undefined\n}\n\nexport const heroModule: Module = { pre, create, destroy, post }\n"]}},"error":null,"hash":"afb843494ee9e0bf48b1d9ad864d06ef","cacheData":{"env":{}}}